# JSON

## Compatibility

This package tries to be fully compatible with `encoding/json` package in standard
library at both API and behavior level.
By default it alias the types and functions in the standard library.

To get better performance, you can build your application with tag `jsoniter`
to use [jsoniter], which announces itself 100% compatible drop-in replacement
of `encoding/json` and is tested by a lot of projects.

[jsoniter]: https://github.com/json-iterator/go

## High performance

For `map[string]string` type, hand-written code is used to get the best performance:

1. `MarshalStringMapUnordered(strMap map[string]string) ([]byte, error)`
1. `AppendStringMapUnordered(buf []byte, strMap map[string]string) ([]byte, error)`
1. `UnmarshalStringMap(data []byte, dst *map[string]string) error`

Also choose `jsoniter` will always give you better performance than the standard library.

## Extension

### Utilities

String operation avoiding unnecessary memory allocation:

1. `MarshalToString(v interface{}) (string, error)`
1. `UnmarshalFromString(str string, v interface{}) error`

Get data of specific path without defining the struct:

1. `Get(data []byte, path ...interface{}) Any`
1. `GetByDot(data []byte, path string) Any`

Handy shortcuts to load and dump JSON data from/to file:

1. `Load(path string, v interface{}) error`
1. `Dump(path string, v interface{}) error`

### Extended syntax

`UnmarshalExt`, `ExtDecoder` and `LoadExt` extends the json syntax with following features:

1. trailing comma of Object and Array
1. traditional, end of line, or pragma comments
1. Python boolean constants
1. Python None as null
1. Python style single quote string
1. import other JSON files (with max depth limited)

It helps in many scenes, such as developing test data generated by python program,
configuration with comments, or managing many json files with duplicate contents.

## Benchmark

```text
goos: darwin
goarch: amd64
pkg: github.com/jxskiss/gopkg/json

BenchmarkMarshalStringMap-12                             2076801               550 ns/op             256 B/op          1 allocs/op
BenchmarkMarshalStringMap_JSONIter-12                     469203              2574 ns/op            1785 B/op         21 allocs/op
BenchmarkMarshalStringMap_Standard-12                     387316              3123 ns/op            1376 B/op         25 allocs/op

BenchmarkMarshalStringInterfaceMap-12                     260229              4194 ns/op             984 B/op          6 allocs/op
BenchmarkMarshalStringInterfaceMap_JSONIter-12             87493             13790 ns/op            5428 B/op         73 allocs/op
BenchmarkMarshalStringInterfaceMap_Standard-12             74056             16359 ns/op            5474 B/op         97 allocs/op

BenchmarkUnmarshalStringMap-12                            580996              2044 ns/op            1201 B/op          7 allocs/op
BenchmarkUnmarshalStringMap_JSONIter-12                   445468              2971 ns/op            1505 B/op         46 allocs/op
BenchmarkUnmarshalStringMap_Standard-12                   186709              6660 ns/op            2057 B/op         55 allocs/op
```
